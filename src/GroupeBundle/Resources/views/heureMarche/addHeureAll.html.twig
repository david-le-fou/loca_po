{% extends 'base.html.twig' %}

{% block titre %}Ajouter les heures de marches{% endblock %}
{% block titre_page %}Ajouter les heures de marches{% endblock %}
{% block titre_description %}<br>Ajouter les heures de marches</br>{% endblock %}
{% block body %}
    <style>
        /* The container_check */
        .container_check {
            display: block;
            position: relative;
            padding-left: 35px;
            margin-bottom: 12px;
            cursor: pointer;
            font-size: 22px;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        /* Hide the browser's default checkbox */
        .container_check input {
            position: absolute;
            opacity: 0;
            cursor: pointer;
            height: 0;
            width: 0;
        }

        /* Create a custom checkbox */
        .checkmark {
            position: absolute;
            top: 0;
            left: 0;
            height: 25px;
            width: 25px;
            background-color: #eee;
        }

        /* On mouse-over, add a grey background color */
        .container_check:hover input ~ .checkmark {
            background-color: #ccc;
        }

        /* When the checkbox is checked, add a blue background */
        .container_check input:checked ~ .checkmark {
            background-color: #2196F3;
        }

        /* Create the checkmark/indicator (hidden when not checked) */
        .checkmark:after {
            content: "";
            position: absolute;
            display: none;
        }

        /* Show the checkmark when checked */
        .container_check input:checked ~ .checkmark:after {
            display: block;
        }

        /* Style the checkmark/indicator */
        .container_check .checkmark:after {
            left: 9px;
            top: 5px;
            width: 5px;
            height: 10px;
            border: solid white;
            border-width: 0 3px 3px 0;
            -webkit-transform: rotate(45deg);
            -ms-transform: rotate(45deg);
            transform: rotate(45deg);
        }
        .checkBtn > .btn {
            background-color: DodgerBlue;
            border: none;
            color: white;
            padding: 12px 16px;
            font-size: 16px;
            cursor: pointer;
        }

        /* Darker background on mouse-over */
        .checkBtn > .btn:hover {
            background-color: RoyalBlue;
        }
        .border{
            border-image: linear-gradient(to right, #bb2124,#bb2124);
            border-image-slice: 1;
            border-width: 3px;

        }
    </style>


<div class="col-md-10">
    <div class="box ">

        <table class="table checkBtn" >

            <tbody>
            <tr>

                <td >
                    <div class="form-group">

                        <div class="input-group date form_date" data-date="" data-link-field="principaleDateDebut" data-link-format="dd/mm/yyyy">
                            <label for="date" class="input-group-addon control-label">Date Début :</label>
                            <input  class="form-control  "   type="text"  id="principaleDateDebut" name="principaleDateDebut">
                            <span class="input-group-addon"><span class="glyphicon glyphicon-remove"></span></span>
                            <span class="input-group-addon"><span  class="glyphicon glyphicon-calendar"></span></span>
                        </div>


                    </div>
                </td>
                <td></td>
                <td  class="border-left "></td>
                <td >
                    <div class="form-group">

                        <div class="input-group date form_date" data-date="" data-link-field="principaleDateFin" data-link-format="dd/mm/yyyy">
                            <label for="date" class="input-group-addon control-label">Date Fin:</label>
                            <input class="form-control"  type="text" id="principaleDateFin"  name="principaleDateFin">
                            <span class="input-group-addon"><span class="glyphicon glyphicon-remove"></span></span>
                            <span class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span></span>
                        </div>

                    </div>
               </td>

            </tr>

            </tbody>
        </table>

    </div>
</div>
    <form action="#" method="post" autocomplete="off">
        <div class="row">
            <div class="col-md-12">
                <div class="box">
                    <div class="box-header with-border">
                        <h3 class="box-title">Table liste</h3>
                    </div>
                    <!-- /.box-header -->
                    <div class="box-body">
                        <table class="table table-striped table-bordered" id="tableGroupe">
                            <thead>
                            <tr>
                                <th>
                                     <label class="container_check">
                                        <input id="selectAll" class="check" type="checkbox" >
                                        <span class="checkmark"></span>
                                    </label>
                                    <br>
                                </th>
                                <th>Numero</th>
                                <th>Site</th>
                                <th>Date de début</th>
                                <th>Date fin</th>
                                <th >Heure(s)</th>
                                <th>Puissance(s) </th>
                            </tr>
                            </thead>
                            <tbody>
                            {% for groupe in groupes %}

                                <tr>
                                    <td>
                                        <label class="container_check">
                                            <input class="check" type="checkbox" name="check[]" value="{{ groupe.id }}" >
                                            <span class="checkmark"></span>
                                        </label>
                                    </td>
                                    <td>
                                        <a  class="{{ groupe.id }}"  href="{{ path('groupe_show',{'id':groupe.id}) }}">{{ groupe.numero }}</a>
                                    </td>
                                    <td>{{ groupe.site.emplacement }}</td>
                                    <td >
                                        <div class="form-group">

                                            <div class="input-group date form_date" data-date="" data-link-field="{{ 'debutdebut'~ groupe.id }}" data-link-format="dd/mm/yyyy">

                                                <input class="form-control debut" id="{{ 'debutdebut'~ groupe.id }}"  type="text"  name="{{ 'debut'~ groupe.id }}">
                                                <span class="input-group-addon"><span class="glyphicon glyphicon-remove"></span></span>
                                                <span class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span></span>
                                            </div>

                                        </div>
                                    </td>
                                    <td >
                                        <div class="form-group">

                                            <div class="input-group date form_date" data-date="" data-link-field="{{ 'debutfin'~ groupe.id }}" data-link-format="dd/mm/yyyy">

                                                <input class="form-control fin"  id="{{ 'debutfin'~ groupe.id }}"type="text"  name="{{ 'fin'~ groupe.id }}">
                                                <span class="input-group-addon"><span class="glyphicon glyphicon-remove"></span></span>
                                                <span class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span></span>
                                            </div>

                                        </div>
                                    </td>
                                    <td >
                                        <div class="">
                                            <input onfocus="foc({{ 'heure'~ groupe.id }})" type="text"  id ="{{ 'heure'~ groupe.id }}"  name="{{ 'heure'~ groupe.id }}" class="form-control">

                                        </div>
                                    </td>
                                    <td >
                                        <div class="">
                                            <input value="{{ groupe.puissanceconsommer }}" type="text" name="{{ 'puissance'~ groupe.id }}" class="form-control col-6">
                                        </div>
                                    </td>
                                </tr>
                            {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <div class="text-right">
            <button type="submit" id="btn" class="btn btn-primary btn-lg"><i class="fa fa-save"></i> Enregistrer</button>
            <a href="{{ path('heureMarche_index') }}" class="btn btn-default btn-lg"> Annuler</a>
        </div>


    </form>
    <div class="modal modal-default fade" id="modalHeure">
        <form action="{{ path('heureMarche_simpleAjout') }}" method="post">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" > Veuillez remplire tous les zones de texte</h4>
                    </div>

                    <div class="modal-body">

                        <table  >

                            <tbody>
                            <tr>
                                <input type="hidden" name="idgroupe" id="out">
                                <td >
                                    <div class="form-group">

                                        <div class="input-group date form_date" data-date="" data-link-field="DateDebut" data-link-format="dd/mm/yyyy">
                                            <label for="date" class="input-group-addon control-label">Date Début :</label>
                                            <input  class="form-control "   type="text"  id="DateDebut" name="datedebut">
                                            <span class="input-group-addon"><span class="glyphicon glyphicon-remove"></span></span>
                                            <span class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span></span>
                                        </div>

                                    </div>
                                </td>
                                <td>&nbsp&nbsp</td>
                                <td >
                                    <div class="form-group">

                                        <div class="input-group date form_date" data-date="" data-link-field="DateFin" data-link-format="dd/mm/yyyy">
                                            <label for="date" class="input-group-addon control-label">Date Fin:</label>
                                            <input class="form-control"  type="text" id="DateFin"  name="datefin">
                                            <span class="input-group-addon"><span class="glyphicon glyphicon-remove"></span></span>
                                            <span class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span></span>
                                        </div>

                                    </div>

                                </td>

                            </tr>
                            <tr>
                                <td> <div class="form-group">

                                        <div class="input-group " >
                                            <label for="date" class="input-group-addon control-label">Heure de marche:</label>
                                            <input class="form-control"  type="text" id="heure"  name="heure">

                                        </div>

                                    </div></td>

                            </tr>
                            </tbody>
                        </table>

                    </div>
                    <div class="modal-footer">
                        <button type="submit" id="btn" class="btn btn-outline btn-success" >Enregistrer</button>
                        <button type="button" class="btn btn-outline btn-default" data-dismiss="modal">Fermer</button>
                    </div>
                </div>
                <!-- /.modal-content -->
            </div>
        </form>

        <!-- /.modal-dialog -->
    </div>
<!-- DataTables JS -->
<script src="{{ asset('AdminLTE/bower_components/datatables.net/js/jquery.dataTables.min.js') }}"></script>
<script src="{{ asset('AdminLTE/bower_components/datatables.net-bs/js/dataTables.bootstrap.min.js') }}"></script>
<!-- DataTables CSS -->
<link rel="stylesheet"  href="{{ asset('AdminLTE/bower_components/datatables.net-bs/css/dataTables.bootstrap.min.css') }}">


<script>
    $(document).ready(function() {
        $('#tableGroupe').DataTable({
            pageLength: 25,
            order: [[ 1, "asc" ]],
            "aoColumnDefs" : [
                {
                    "bSortable" : false,
                    "aTargets" : [ 0]
                }],
            "aoColumns" : [],
            paginate:false,
            language: {
                processing:     "Traitement en cours...",
                search:         "Rechercher&nbsp;:",
                lengthMenu:    "Afficher _MENU_ &eacute;l&eacute;ments",
                info:           "Affichage de l'&eacute;lement _START_ &agrave; _END_ sur _TOTAL_ &eacute;l&eacute;ments",
                infoEmpty:      "Affichage de l'&eacute;lement 0 &agrave; 0 sur 0 &eacute;l&eacute;ments",
                infoFiltered:   "(filtr&eacute; de _MAX_ &eacute;l&eacute;ments au total)",
                infoPostFix:    "",
                loadingRecords: "Chargement en cours...",
                zeroRecords:    "Aucun &eacute;l&eacute;ment &agrave; afficher",
                emptyTable:     "Aucune donnée disponible dans le tableau",
                paginate: {
                    first:      "Premier",
                    previous:   "Pr&eacute;c&eacute;dent",
                    next:       "Suivant",
                    last:       "Dernier"
                },
                aria: {
                    sortAscending:  ": activer pour trier la colonne par ordre croissant",
                    sortDescending: ": activer pour trier la colonne par ordre décroissant"
                },

            }
        });
    } );


        numeralFormat('#produitbundle_produit_prixAchat');
        numeralFormat('#produitbundle_produit_prixVente');
    </script>

    {#DATEPICKER#}
    <script src="{{ asset('DatePicker1/js/bootstrap-datetimepicker.min.js') }}"></script>
    <script type="text/javascript" src="{{ asset('DatePicker1/js/locales/bootstrap-datetimepicker.fr.js') }}" charset="UTF-8"></script>
    <script>
        $('.form_date').datetimepicker({
            format: 'dd/mm/yyyy',
            language:  'fr',
            weekStart: 1,
            todayBtn:  1,
            autoclose: 1,
            todayHighlight: 1,
            startView: 2,
            minView: 2,
            forceParse: 0
        });
    </script>
    <script>
        $( "#principaleDateDebut" ).focus(function() {
            $('#principaleDateDebut').removeClass('border')
        });
        $( "#principaleDateFin" ).focus(function() {
            $('#principaleDateFin').removeClass('border')
        });
        $('#btn').click(function () {
            var reponse='true';

            var date = $('#principaleDateDebut').val();
            var date1 = $('#principaleDateFin').val();
            if((date=="") ||(date1==""))
            {$('#textModalDanger').text('Erreur! Veuillez remplire toutes les champs dates');
                $('#modalDanger').modal();
                if(date==""){

                    $('#principaleDateDebut').addClass('border')
                    reponse=false;
                }
                if(date1==""){

                    $('#principaleDateFin').addClass('border')
                    reponse=false;
                }


            }
            else{
                $.each($("input[name='check[]']:checked"), function() {
                    if($('#heure'+$(this).val()).val()=="")
                    {

                        $('#textModalDanger').text('Erreur! Veuillez remplire les champs heure cocher');
                        $('#modalDanger').modal();
                        reponse=false;

                    }
                    if($('#heure'+$(this).val()).val()=="")
                    {
                        $('#heure'+$(this).val()).addClass('border')


                        reponse=false;

                    }

                });
            }





            return reponse;

        })

    </script>
    <script>
        function foc($param) {

            $($param).removeClass('border')

        }
        function modal(id){
                $('#out').val(id)
                $('#modalHeure').modal();

        }

        $("#principaleDateDebut").change(function () {
            var date = $('#principaleDateDebut').val();
            $('.debut').val($('#principaleDateDebut').val())
            $("#principaleDateDebut").removeClass('border')
        });
        $("#principaleDateFin").change(function () {

            var date1 = $('#principaleDateFin').val();
            $('.fin').val($('#principaleDateFin').val())
            $("#principaleDateFin").removeClass('border')
        });

        $('#selectAll').click(function () {
            if($(this).is(":checked")) $('.check').prop('checked',true);
            else $('.check').prop('checked',false);
        });

        $('#selectAll').click();

    </script>

{% endblock %}